{"version":3,"file":null,"sources":["../src/api.js","../src/util/array.js","../src/request/paramify.js","../src/request/jsonp.js","../src/yourls-db.js","../src/yourls-url.js","../src/yourls.js"],"sourcesContent":["/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * The singleton {@link API} instance which is privatized to prevent leaking credentials.\n *\n * @private\n * @type {API}\n */\nvar instance = null\n\n/**\n * Sanitizes the specified <code>credentials</code> by ensuring that only valid properties are present and only when\n * appropriate.\n *\n * This function does not modify <code>credentials</code> and instead creates a new object with the sanitized\n * properties.\n *\n * @param {API~Credentials} credentials - the credentials to be sanitized (may be <code>null</code>)\n * @return {API~Credentials} A sanitized version of <code>credentials</code> or <code>null</code> if\n * <code>credentials</code> is <code>null</code>.\n * @private\n */\nfunction sanitizeCredentials(credentials) {\n  if (!credentials) {\n    return null\n  }\n\n  var result = {}\n  if (credentials.signature) {\n    result.signature = credentials.signature\n    result.timestamp = credentials.timestamp\n  } else {\n    result.password = credentials.password\n    result.username = credentials.username\n  }\n\n  return result\n}\n\n/**\n * Contains information on how to connect to and authenticate with a YOURLS server.\n *\n * @param {string} [url=''] - the URL for the YOURLS server\n * @param {API~Credentials} [credentials] - the credentials to be used to authenticate with the YOURLS API (may be\n * <code>null</code>)\n * @protected\n * @constructor\n */\nexport function API(url, credentials) {\n  /**\n   * The URL of the YOURLS server.\n   *\n   * @public\n   * @type {string}\n   */\n  this.url = url ? url.replace(/\\/$/, '') : ''\n  /**\n   * The credentials to be used to authenticate with the YOURLS API.\n   *\n   * This may be <code>null</code> if the YOURLS API is public.\n   *\n   * @public\n   * @type {API~Credentials}\n   */\n  this.credentials = sanitizeCredentials(credentials)\n}\n\n/**\n * Destroys the singleton instance of {@link API}.\n *\n * @return {void}\n * @public\n * @static\n */\nAPI.clear = function() {\n  instance = null\n}\n\n/**\n * Retrieves the singleton instance of {@link API}.\n *\n * This function will return <code>null</code> unless an instance is currently stored.\n *\n * @return {API} The connected {@link API} or <code>null</code> if none exists.\n * @public\n * @static\n */\nAPI.fetch = function() {\n  return instance\n}\n\n/**\n * Stores this {@link API} as the singleton, potentially replacing the existing instance.\n *\n * @return {void}\n * @public\n */\nAPI.prototype.store = function() {\n  instance = this\n}\n\n/**\n * The credentials to be used to authenticate with a private YOURLS API.\n *\n * Authentication can be done with a traditional username and password combination <b>or</b> by using the secret\n * signature token (e.g. <code>1002a612b4</code>)for the YOURLS API. The latter is not available for public YOURLS APIs\n * and can be found on the \"Tools\" page.\n *\n * Optionally, a timestamp can accompany the signature token to make it time-limited (depending on the server\n * configuration). When a timestamp is provided the signature token <b>must</b> be the md5 sum of the timestamp and\n * signature token concatenated, and in that order.\n *\n * @typedef {Object} API~Credentials\n * @property {string} [password] - The password of the user to be authenticated.\n * @property {string} [username] - The name of the user to be authenticated.\n * @property {string} [signature] - The signature token to be used for passwordless authentication with the YOURLS API.\n * @property {number|string} [timestamp] - The optional timestamp to limit the <code>signature</code> token.\n */\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Returns whether the specified <code>obj</code> is an array.\n *\n * This function will use the native <code>Array.isArray</code>, if available.\n *\n * @param {*} obj - the object to be checked (may be <code>null</code>)\n * @return {boolean} <code>true</code> if <code>obj</code> is an array; otherwise <code>false</code>.\n * @protected\n */\nexport function isArray(obj) {\n  return Array.isArray ? Array.isArray(obj) : Object.prototype.toString.call(obj) === '[object Array]'\n}\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Creates a serialized representation of the specified <code>params</code> into a URL query string.\n *\n * @param {Object} [params] - the hash of parameter key/value pairs to be serialized\n * @return {string} A URL query string representing <code>params</code>.\n * @protected\n */\nexport function paramify(params) {\n  if (!params) {\n    return ''\n  }\n\n  var results = []\n\n  for (var key in params) {\n    if (Object.prototype.hasOwnProperty.call(params, key)) {\n      if (params[key] != null) {\n        results.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]))\n      }\n    }\n  }\n\n  return results.join('&')\n}\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { API } from '../api'\nimport { isArray } from '../util/array'\nimport { paramify } from './paramify'\n\n/**\n * The key of the callback function holder within the global namespace.\n *\n * @private\n * @type {string}\n */\nvar callbackHolderKey = '__yourls' + Date.now() + '_jsonp'\n/**\n * Contains the callback functions for active JSONP requests.\n *\n * Callback references should be removed immediately once they have been called.\n *\n * Due to the nature of JSON, a reference to this object <b>must</b> be publicly available (i.e. global).\n *\n * @private\n * @type {Object<number, Function>}\n */\nvar callbackHolder = window[callbackHolderKey] = {}\n\n/**\n * Generates a quick and dirty unique ID for a callback.\n *\n * @return {number} The generated callback ID.\n * @private\n */\nfunction generateCallbackId() {\n  var id = Date.now()\n  while (callbackHolder[id]) {\n    id++\n  }\n\n  return id\n}\n\n/**\n * Extracts the values of the properties with the specified <code>names</code> from the <code>response</code> provided\n * and returns them in a single result.\n *\n * If <code>names</code> is a string or only contains a single string, only the value for that named property will be\n * returned. Otherwise, an object containing the key/value pairs for each named property will be returned.\n *\n * If <code>response</code> is <code>null</code> this function will return <code>null</code>.\n *\n * @param {string|string[]} names - the names of the <code>response</code> properties whose values are to be returned as\n * the result\n * @param {Object} response - the YOURLS API response\n * @return {*} The result extracted from <code>response</code>.\n * @private\n */\nfunction getResult(names, response) {\n  names = isArray(names) ? names : [ names ]\n\n  var i\n  var name\n  var result = null\n\n  if (!response) {\n    return result\n  }\n\n  if (names.length === 1) {\n    result = response[names[0]]\n  } else {\n    result = {}\n\n    for (i = 0; i < names.length; i++) {\n      name = names[i]\n\n      if (typeof response[name] !== 'undefined') {\n        result[name] = response[name]\n      }\n    }\n  }\n\n  return result\n}\n\n/**\n * Sends a JSONP request to the connected YOURLS API with the <code>data</code> provided which should, in turn, call the\n * specified <code>callback</code> with the result.\n *\n * If the request is successful, <code>callback</code> will be passed the value of the named properties from the\n * response. If <code>resultNames</code> is a string or only contains a single string, only the value for that named\n * property will be passed as the first argument. Otherwise, an object containing the key/value pairs for each named\n * property will be passed as the first argument. The actual response will always be passed as the second argument.\n *\n * Due to the nature of JSONP, all information will be included in the URL of the request. This includes\n * <code>data</code> as well as <b>any credentials</b> used to authenticate with the API. You have been warned.\n *\n * @param {Object} data - the data to be sent\n * @param {string|string[]} resultNames - the names of the response properties whose values are to be passed to\n * <code>callback</code> as the first argument\n * @param {Function} callback - the function to be called with the result\n * @return {void}\n * @protected\n */\nexport function jsonp(data, resultNames, callback) {\n  var api = API.fetch()\n  var id = generateCallbackId()\n  var script = document.createElement('script')\n\n  callbackHolder[id] = function(response) {\n    var result = getResult(resultNames, response)\n\n    delete callbackHolder[id]\n    script.parentNode.removeChild(script)\n\n    callback(result, response)\n  }\n\n  var target = api.url + '?' + paramify({ callback: callbackHolderKey + '[' + id + ']', format: 'jsonp' })\n  if (api.credentials) {\n    target += '&' + paramify(api.credentials)\n  }\n  if (data) {\n    target += '&' + paramify(data)\n  }\n\n  script.setAttribute('src', target)\n  document.getElementsByTagName('head')[0].appendChild(script)\n}\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { jsonp } from './request/jsonp'\n\n/**\n * Provides the ability to lookup information related to the YOURLS database.\n *\n * @constructor\n * @protected\n */\nexport function DB() {\n  // Do nothing\n}\n\n/**\n * Retrieves the statistics for this {@link DB}.\n *\n * @param {Function} callback - the callback function to be called with the result\n * @return {DB} A reference to this {@link DB} for chaining purposes.\n * @public\n */\nDB.prototype.stats = function(callback) {\n  var data = { action: 'db-stats' }\n\n  jsonp(data, 'db-stats', callback)\n\n  return this\n}\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE0\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { jsonp } from './request/jsonp'\n\n/**\n * Provides the ability to lookup information related to the specified shortened <code>url</code>.\n *\n * @param {string} url - the shortened URL (or its keyword) to be used\n * @constructor\n * @protected\n */\nexport function URL(url) {\n  /**\n   * Either the shortened URL or its keyword for this {@link URL}.\n   *\n   * @public\n   * @type {string}\n   */\n  this.url = url\n}\n\n/**\n * Retrieves the original (\"long\") URL for this shortened {@link URL}.\n *\n * @param {Function} callback - the callback function to be called with the result\n * @return {URL} A reference to this {@link URL} for chaining purposes.\n * @public\n */\nURL.prototype.expand = function(callback) {\n  var data = {\n    action: 'expand',\n    shorturl: this.url\n  }\n\n  jsonp(data, [ 'keyword', 'longurl', 'shorturl' ], callback)\n\n  return this\n}\n\n/**\n * Retrieves the statistics for this shortened {@link URL}.\n *\n * @param {Function} callback - the callback function to be called with the result\n * @return {URL} A reference to this {@link URL} for chaining purposes.\n * @public\n */\nURL.prototype.stats = function(callback) {\n  var data = {\n    action: 'url-stats',\n    shorturl: this.url\n  }\n\n  jsonp(data, 'link', callback)\n\n  return this\n}\n","/*\n * Copyright (C) 2016 Alasdair Mercer\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { API } from './api'\nimport { DB } from './yourls-db'\nimport { isArray } from './util/array'\nimport { jsonp } from './request/jsonp'\nimport { URL } from './yourls-url'\n\n/**\n * Sanitizes the result of {@link YOURLS#stats} so that it's more usable in application code by transforming the links\n * from an object mapping into an array.\n *\n * This function simply returns <code>result</code> if it is <code>null</code>, has no links property or one that is\n * already an array (future-proofing).\n *\n * @param {Object} result - the result to be sanitized (may be <code>null</code>)\n * @param {Object} [result.links] - the links to be transformed into an array (may be <code>null</code>)\n * @return {Object} The modified <code>result</code> or <code>null</code> if <code>result</code> is <code>null</code>.\n * @private\n */\nfunction sanitizeStatsResult(result) {\n  // Future-proofing by sanitizing links *only* when not already an array\n  if (!result || !result.links || isArray(result.links)) {\n    return result\n  }\n\n  var index = 1\n  var link\n  var links = []\n\n  while ((link = result.links['link_' + index]) != null) {\n    links.push(link)\n    index++\n  }\n\n  result.links = links\n\n  return result\n}\n\n/**\n * Provides the ability to connect to YOURLS servers and perform read/write operations via the API that they expose.\n *\n * Before attempting to interact with a YOURLS server, you <b>must</b> call {@link YOURLS#connect} first to configure\n * the URL of the YOURLS server and any credentials required to authenticate with its API (only required when private).\n *\n * @constructor\n * @protected\n */\nvar YOURLS = function() {\n  /**\n   * Provides information on the YOURLS {@link DB}.\n   *\n   * @public\n   * @type {DB}\n   */\n  this.db = new DB()\n\n  /**\n   * The current version of <code>yourls</code>.\n   *\n   * This is <b>not</b> the same as the version of YOURLS that is being connected to. The {@link YOURLS#version}\n   * function should be used to provide that information.\n   *\n   * @public\n   * @type {string}\n   */\n  this.VERSION = '2.0.0'\n}\n\n/**\n * Stores the specified information to be used later to connect to and authenticate with a YOURLS server.\n *\n * @param {string} [url=''] - the URL for the YOURLS server\n * @param {API~Credentials} [credentials] - the credentials to be used to authenticate with the YOURLS API (may be\n * <code>null</code>)\n * @return {YOURLS} A reference to this {@link YOURLS} for chaining purposes.\n * @public\n */\nYOURLS.prototype.connect = function(url, credentials) {\n  var api = new API(url, credentials)\n  api.store()\n\n  return this\n}\n\n/**\n * Clears any information that may have been previously stored for connecting to and authenticating with a YOURLS\n * server.\n *\n * @return {YOURLS} A reference to this {@link YOURLS} for chaining purposes.\n * @public\n */\nYOURLS.prototype.disconnect = function() {\n  API.clear()\n\n  return this\n}\n\n/**\n * Creates a short URL for the specified long <code>url</code>.\n *\n * Optionally, a <code>descriptor</code> can be provided to specify a keyword and/or title for the short URL that is to\n * be created. If a keyword is specified, it must be available and, if not, the YOURLS server will generate a unique\n * keyword. If <code>descriptor</code> is a string, it will be treated as the keyword.\n *\n * @param {string} url - the long URL to be shortened\n * @param {YOURLS~UrlDescriptor|string} [descriptor] - the optional descriptor (or keyword, if it's a string) to be used\n * for the short URL\n * @param {Function} callback - the callback function to be called with the result\n * @return {YOURLS} A reference to this {@link YOURLS} for chaining purposes.\n * @public\n */\nYOURLS.prototype.shorten = function(url, descriptor, callback) {\n  var data = {\n    action: 'shorturl',\n    url: url\n  }\n\n  switch (typeof descriptor) {\n  case 'function':\n    callback = descriptor\n    descriptor = null\n    break\n  case 'string':\n    descriptor = { keyword: descriptor }\n    break\n  default:\n    // Do nothing\n  }\n\n  if (descriptor) {\n    data.keyword = descriptor.keyword\n    data.title = descriptor.title\n  }\n\n  jsonp(data, [ 'shorturl', 'title', 'url' ], callback)\n\n  return this\n}\n\n/**\n * Retrieves the statistics for all URLs shortened by the current user, if authenticating with a username/password\n * combination, otherwise all shortened URLs.\n *\n * Optionally, <code>criteria</code> can be provided to also include a refined set of links in the result. This includes\n * filter, which provides limited control over the sorting, as well as limit and start, which allow for pagination. If\n * <code>criteria</code> is a number, it will be treated as the limit.\n *\n * No links will be included in the result unless a limit is specified that is greater than zero.\n *\n * @param {YOURLS~SearchCriteria|number} [criteria] - the optional criteria (or limit, if it's a number) to be used to\n * search for links to be included in the result\n * @param {Function} callback - the callback function to be called with the result\n * @return {YOURLS} A reference to this {@link YOURLS} for chaining purposes.\n * @public\n */\nYOURLS.prototype.stats = function(criteria, callback) {\n  var data = { action: 'stats' }\n\n  switch (typeof criteria) {\n  case 'function':\n    callback = criteria\n    criteria = null\n    break\n  case 'number':\n    criteria = { limit: criteria }\n    break\n  default:\n    // Do nothing\n  }\n\n  if (criteria) {\n    data.filter = criteria.filter\n    data.limit = criteria.limit\n    data.start = criteria.start\n  }\n\n  jsonp(data, [ 'links', 'stats' ], function(result, response) {\n    callback(sanitizeStatsResult(result), response)\n  })\n\n  return this\n}\n\n/**\n * Creates an instance of {@link URL} for the specified shortened <code>url</code> which can be used to lookup more\n * detailed information relating to it.\n *\n * No data is fetched just by calling this function; one of the functions on the returned instance need to be called for\n * that to happen.\n *\n * @param {string} url - the shortened URL (or its keyword)\n * @return {URL} The {@link URL} created for the shortened <code>url</code> or <code>null</code> if <code>url</code> is\n * <code>null</code>.\n * @public\n */\nYOURLS.prototype.url = function(url) {\n  return url ? new URL(url) : null\n}\n\n/**\n * Retrieves the version of the connected YOURLS API.\n *\n * @param {Function} callback - the callback function to be called with the result\n * @return {YOURLS} A reference to this {@link YOURLS} for chaining purposes.\n * @public\n */\nYOURLS.prototype.version = function(callback) {\n  var data = { action: 'version' }\n\n  jsonp(data, 'version', callback)\n\n  return this\n}\n\n/**\n * The singleton instance of {@link YOURLS}.\n */\nexport default new YOURLS()\n\n/**\n * Contains criteria which can be used to search for a refined set of shortened URLs.\n *\n * Pagination can be achieved by using <code>limit</code> and <code>start</code>.\n *\n * No links will be returned unless <code>limit</code> is specified and has a value that is greater than zero.\n *\n * @typedef {Object} YOURLS~SearchCriteria\n * @property {string} [filter] - The filter to be applied (either <code>\"top\"</code>, <code>\"bottom\"</code>,\n * <code>\"rand\"</code>, or <code>\"last\"</code>).\n * @property {number} [limit] - The maximum number of links whose statistical information is to be counted.\n * <code>null</code> or <code>0</code> will result in no links being included in the result.\n * @property {number} [start] - The offset from where the search should begin.\n */\n\n/**\n * Contains additional information which can be used when shortening a URL.\n *\n * If <code>keyword</code> is specified, it must be available and, if not, the YOURLS server will generate a unique\n * keyword.\n *\n * @typedef {Object} YOURLS~UrlDescriptor\n * @property {string} [keyword] - The optional keyword to be used for the shortened URL.\n * @property {string} [title] - The optional title to be associated with the shortened URL.\n */\n"],"names":["sanitizeCredentials","credentials","result","signature","timestamp","password","username","API","url","this","replace","isArray","obj","Array","Object","prototype","toString","call","paramify","params","results","key","hasOwnProperty","push","encodeURIComponent","join","generateCallbackId","id","Date","now","callbackHolder","getResult","names","response","i","name","length","jsonp","data","resultNames","callback","api","fetch","script","document","createElement","parentNode","removeChild","target","callbackHolderKey","format","setAttribute","getElementsByTagName","appendChild","DB","URL","sanitizeStatsResult","links","link","index","instance","clear","store","window","stats","action","expand","shorturl","YOURLS","db","VERSION","connect","disconnect","shorten","descriptor","keyword","title","criteria","limit","filter","start","version"],"mappings":";8LA0CA,SAASA,GAAoBC,GAC3B,IAAKA,EACH,MAAO,KAGT,IAAIC,KASJ,OARID,GAAYE,WACdD,EAAOC,UAAYF,EAAYE,UAC/BD,EAAOE,UAAYH,EAAYG,YAE/BF,EAAOG,SAAWJ,EAAYI,SAC9BH,EAAOI,SAAWL,EAAYK,UAGzBJ,EAYF,QAASK,GAAIC,EAAKP,GAOvBQ,KAAKD,IAAMA,EAAMA,EAAIE,QAAQ,MAAO,IAAM,GAS1CD,KAAKR,YAAcD,EAAoBC,GCrDlC,QAASU,GAAQC,GACtB,MAAOC,OAAMF,QAAUE,MAAMF,QAAQC,GAA+C,mBAAxCE,OAAOC,UAAUC,SAASC,KAAKL,GCHtE,QAASM,GAASC,GACvB,IAAKA,EACH,MAAO,EAGT,IAAIC,KAEJ,KAAK,GAAIC,KAAOF,GACVL,OAAOC,UAAUO,eAAeL,KAAKE,EAAQE,IAC5B,MAAfF,EAAOE,IACTD,EAAQG,KAAKC,mBAAmBH,GAAO,IAAMG,mBAAmBL,EAAOE,IAK7E,OAAOD,GAAQK,KAAK,KCOtB,QAASC,KAEP,IADA,GAAIC,GAAKC,KAAKC,MACPC,EAAeH,IACpBA,GAGF,OAAOA,GAkBT,QAASI,GAAUC,EAAOC,GACxBD,EAAQrB,EAAQqB,GAASA,GAAUA,EAEnC,IAAIE,GACAC,EACAjC,EAAS,IAEb,KAAK+B,EACH,MAAO/B,EAGT,IAAqB,IAAjB8B,EAAMI,OACRlC,EAAS+B,EAASD,EAAM,QAIxB,KAFA9B,KAEKgC,EAAI,EAAGA,EAAIF,EAAMI,OAAQF,IAC5BC,EAAOH,EAAME,GAEiB,mBAAnBD,GAASE,KAClBjC,EAAOiC,GAAQF,EAASE,GAK9B,OAAOjC,GAsBF,QAASmC,GAAMC,EAAMC,EAAaC,GACvC,GAAIC,GAAMlC,EAAImC,QACVf,EAAKD,IACLiB,EAASC,SAASC,cAAc,SAEpCf,GAAeH,GAAM,SAASM,GAC5B,GAAI/B,GAAS6B,EAAUQ,EAAaN,SAE7BH,GAAeH,GACtBgB,EAAOG,WAAWC,YAAYJ,GAE9BH,EAAStC,EAAQ+B,GAGnB,IAAIe,GAASP,EAAIjC,IAAM,IAAMU,GAAWsB,SAAUS,EAAoB,IAAMtB,EAAK,IAAKuB,OAAQ,SAC1FT,GAAIxC,cACN+C,GAAU,IAAM9B,EAASuB,EAAIxC,cAE3BqC,IACFU,GAAU,IAAM9B,EAASoB,IAG3BK,EAAOQ,aAAa,MAAOH,GAC3BJ,SAASQ,qBAAqB,QAAQ,GAAGC,YAAYV,GCnHhD,QAASW,MCCT,QAASC,GAAI/C,GAOlBC,KAAKD,IAAMA,ECEb,QAASgD,GAAoBtD,GAE3B,IAAKA,IAAWA,EAAOuD,OAAS9C,EAAQT,EAAOuD,OAC7C,MAAOvD,EAOT,KAJA,GACIwD,GADAC,EAAQ,EAERF,KAE6C,OAAzCC,EAAOxD,EAAOuD,MAAM,QAAUE,KACpCF,EAAMlC,KAAKmC,GACXC,GAKF,OAFAzD,GAAOuD,MAAQA,EAERvD,KN7BL0D,GAAW,IAkEfrD,GAAIsD,MAAQ,WACVD,EAAW,MAYbrD,EAAImC,MAAQ,WACV,MAAOkB,IASTrD,EAAIQ,UAAU+C,MAAQ,WACpBF,EAAWnD,SGtFTwC,GAAoB,WAAarB,KAAKC,MAAQ,SAW9CC,EAAiBiC,OAAOd,KCF5BK,GAAGvC,UAAUiD,MAAQ,SAASxB,GAC5B,GAAIF,IAAS2B,OAAQ,WAIrB,OAFA5B,GAAMC,EAAM,WAAYE,GAEjB/B,MCET8C,EAAIxC,UAAUmD,OAAS,SAAS1B,GAC9B,GAAIF,IACF2B,OAAQ,SACRE,SAAU1D,KAAKD,IAKjB,OAFA6B,GAAMC,GAAQ,UAAW,UAAW,YAAcE,GAE3C/B,MAUT8C,EAAIxC,UAAUiD,MAAQ,SAASxB,GAC7B,GAAIF,IACF2B,OAAQ,YACRE,SAAU1D,KAAKD,IAKjB,OAFA6B,GAAMC,EAAM,OAAQE,GAEb/B,SCLL2D,GAAS,WAOX3D,KAAK4D,GAAK,GAAIf,GAWd7C,KAAK6D,QAAU,QAYjBF,GAAOrD,UAAUwD,QAAU,SAAS/D,EAAKP,GACvC,GAAIwC,GAAM,GAAIlC,GAAIC,EAAKP,EAGvB,OAFAwC,GAAIqB,QAEGrD,MAUT2D,EAAOrD,UAAUyD,WAAa,WAG5B,MAFAjE,GAAIsD,QAEGpD,MAiBT2D,EAAOrD,UAAU0D,QAAU,SAASjE,EAAKkE,EAAYlC,GACnD,GAAIF,IACF2B,OAAQ,WACRzD,IAAKA,EAGP,cAAekE,IACf,IAAK,WACHlC,EAAWkC,EACXA,EAAa,IACb,MACF,KAAK,SACHA,GAAeC,QAASD,GAa1B,MAPIA,KACFpC,EAAKqC,QAAUD,EAAWC,QAC1BrC,EAAKsC,MAAQF,EAAWE,OAG1BvC,EAAMC,GAAQ,WAAY,QAAS,OAASE,GAErC/B,MAmBT2D,EAAOrD,UAAUiD,MAAQ,SAASa,EAAUrC,GAC1C,GAAIF,IAAS2B,OAAQ,QAErB,cAAeY,IACf,IAAK,WACHrC,EAAWqC,EACXA,EAAW,IACX,MACF,KAAK,SACHA,GAAaC,MAAOD,GAgBtB,MAVIA,KACFvC,EAAKyC,OAASF,EAASE,OACvBzC,EAAKwC,MAAQD,EAASC,MACtBxC,EAAK0C,MAAQH,EAASG,OAGxB3C,EAAMC,GAAQ,QAAS,SAAW,SAASpC,EAAQ+B,GACjDO,EAASgB,EAAoBtD,GAAS+B,KAGjCxB,MAeT2D,EAAOrD,UAAUP,IAAM,SAASA,GAC9B,MAAOA,GAAM,GAAI+C,GAAI/C,GAAO,MAU9B4D,EAAOrD,UAAUkE,QAAU,SAASzC,GAClC,GAAIF,IAAS2B,OAAQ,UAIrB,OAFA5B,GAAMC,EAAM,UAAWE,GAEhB/B,YAMM,GAAI2D"}